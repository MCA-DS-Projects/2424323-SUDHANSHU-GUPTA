# render.yaml

services:
  # Backend API service
  - type: web
    name: prospeak-ai-backend
    env: python
    plan: free
    region: oregon
    
    # Build configuration
    buildCommand: |
      pip install -r requirements.txt
    
    # Start command - important: use $PORT environment variable
    startCommand: gunicorn --bind 0.0.0.0:$PORT run:app
    
    # Health check path
    healthCheckPath: /api/auth/me
    
    # Environment variables
    envVars:
      - key: SECRET_KEY
        generateValue: true
      - key: JWT_SECRET_KEY
        generateValue: true
      - key: FLASK_ENV
        value: production
      - key: FLASK_DEBUG
        value: false
      - key: MONGODB_URI
        value: "mongodb+srv://sguptaperfect2001_db_user:sgjiLuNNAUPG0QHd@cluster0.yblp5da.mongodb.net/prospeak_ai?retryWrites=true&w=majority"
      - key: OPENAI_API_KEY
        value: 8cbdab37a4170bc49007f46e990d2277
      - key: GEMINI_API_KEY
        value: AIzaSyBZnv-1ablwVQiVrydpiwRUo4JvfnAqyDI

  # Frontend static site (if you're deploying frontend separately)
  - type: web
    name: prospeak-ai-frontend
    env: static
    plan: free
    region: oregon
    buildCommand: |
      echo "Building frontend..."
    staticPublishPath: ./app/static
    routes:
      - type: rewrite
        source: /*
        destination: /index.html
    headers:
      - path: /*
        name: Cache-Control
        value: no-cache